{% load fieldtype %}

{% for hidden in form.hidden_fields %}
  {{ hidden }}
{% endfor %}
{% for field in form.visible_fields %}
  <div class="{% if field.errors%}error{%endif%}">
    <div class="control-group {% if field.errors %}error{% endif %}">
        {% if field|fieldtype:'checkboxinput' %}
          <label class="checkbox">
            {{field}}
            {{field.label}}
            {% if field.errors %}
              <span class="help-inline pull-right">
                {% for error in field.errors %}
                  {{ error }}
                {% endfor %}
              </span>
            {% endif %}
            <span class="help-block">
              {{ field.help_text }}
            </span>
          </label>
        {% else %}
          <label class="control-label" for="{{field.id_for_label}}">{{field.label}}</label>
          <div class="controls">
            {{ field }}
            {% if field.help_text %}
              <span class="help-block">
                {{ field.help_text }}
              </span>
            {% endif %}
            {% if field.errors %}
              <span class="help-inline pull-right">
                {% for error in field.errors %}
                  {{ error }}
                {% endfor %}
              </span>
            {% endif %}
          </div>
        {% endif %}
    </div>
  </div>
{% endfor %}
